<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>GitHub and R</title>
    <meta charset="utf-8" />
    <meta name="author" content="McCrea Cobb" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# GitHub and R
## An Introduction for FWS Biologists
### McCrea Cobb
### 3/19/2020

---







background-image: url(images/)


---
class: center, middle
# Outline 
&lt;br&gt;
### - What is version control
### - What is Git and GitHub
### - Getting set up
### - The basics


???
- Today, I will review the idea of version control and provide some reasons when and why you should use it. 

- Next, I will describe options for implementing version control for your work. I will argue that Git is an ideal version control system for work with R, largely because it works hand-in-hand with GitHub, the online "hub" for sharing and storing projects using Git.

- I will then give an outview of how to get set up for using Git to manage versions of R project files in RStudio

- Finally, I will cover on the basic function in Git and touch on additional features.


---
background-image: url(images/finalfinal.gif)
background-size: contain


???

I think that we've all struggled with trying to manage versions of a file, as shown in the comic here. For example, a report in a Word document that evolves over time and in response to reviewer comments. To maintain versions, what people often do is rename a file, giving it something like Final1 or finalfinal1 or finalfinal1_revised. A better approach might be to append an ISO date to the file name (something like "report_20200319"). This gives the reader an understanding of when the last changes occurred, but they provide no understanding of what the latest change were, who made the changes and why? Wouldn't that info also be useful to know? What about if multiple authors are both working independently on the same document on the same date??


---
# What is ~~vrshun contro1~~ version control?

.pull-left[


**Version control**: the management of changes to documents, computer programs, large web sites, and other collections of information.

**Purpose**:

1. To revert to previous version of a file

2. To keep a history of changes

3. To collaborate on your work simultaneously while managing conflicts
]

.pull-right[
![](images/version_control.png)
]


???
Before we get started, we need to define what we mean by version control. Version control, as defined by WikiPedia (haha) is "the management of changes to documents, computer programs, large web sites, and other collections of information."

For straightforward coding project, there is a single person and two points: start and end. Commonly versions are managed by saving the files under different file names and putting older versions of files into a folder call something like "archive". Sound familiar??

However, when the project increases in complexity, there can be other steps in the process, such as bug fixes, feature requests, and reverts (opps!). With many points in the development timeline, it can be really useful (and sometimes necessary) to have control over the versions along the development path and the development history overall. 

This is a complicated thing. Wouldn't it be nice if there was software that could do that for you??


---
background-image: url(images/git.png)
background-size: cover

???

There is! There are many software available that can help with version control. You might have heard of a few, two of the most well-known are Apache Subversion (SVN) and Git. 

Because this presentation is for FWS R users, I will focus on one of these VCSs called Git. There are a number of appealing things about Git for us:

- Git is open source, 
- Git is free, 
- Git is a distributed system (you don't have to rely on a remote repository hub), 
- you can run Git within RStudio, and
- R users have generally adopted GitHub (which relies on Git) for package development and sharing.


---
# How does it work?

.center[![:scale 75%](images/git_steps.png)]

???

So how does this thing work? Here is a quick rundown of the basic workflow that Git uses to manage versions of file contents:

1. First, you create and edit some files in a local (e.g., your desktop) project directory. 
2. If you want to start a version history of these edits, the first step is to "stage" the files. You access Git functions in the shell (also referred to as Git BASH), a command line interface. Once you are in the shell and navigated to your file directory, the command to stage all files in a file directory is **git add**. What this does is create a folder (hidden) called **.git** and creates copies of each file's contents as blobs (binary large objects). Each file is unique and identified by a unique SHA1 hash (unique 40 character string).

3. After staging files, the next step is to commit these changes to the local repository on your computer. You do this with the **git commit** command. Along with the commit, you are required to create a commit message. This is a description of what was changed or what bug or problem was addressed. Each tree node, commit and file has own unique 40 character long SHA-1 representation (We can say thatâ€™s the key). Together, those elements are added to a tree data structure which is persisted inside .git/objects folder.

4. Rinse and repeat. You can repeat this and even just continue to use local version control. But what if you want to share you're work or you are collaborating with remote partners? This is when you need to share your changes with a remote shared repository.

5. Saving commits from a local repository to a remote repository is a called a **push**. **git push** pushes the changes that you committed to the remote repository. For the examples today, this would be a repository on GitHub. 

6. **git pull** updates the local repository with changes from the remote repository.


Git handles content in snapshots, one for each commit, and knows how to apply or roll back the change sets between two snapshots.

---
background-image: url(images/git_tree.png)


???
This graphic shows the structure of Git objects. 
The first commit (orange) is shown at the bottom, the second commit in the center and the third commit at the top. So, we are working chronologically from bottom to top. 

- The first commit adds a file called "test.txt." The content of this file is saved as a blob (83baae..), which is referenced by the tree object.

- The second commit modifies test.txt, so it creates a new blob. It also adds a new file called "new file".

- The third commit adds a new subdirectory to the working directory that contains the original test.txt file. Notice that instead of creating another new blob, it simply creates a pointer (bak) to the tree in the first commit. Since content of test.txt and new.txt in the working directory are unchanged, the third commit tree points back to the same blobs for these.


---
background-image: url(images/git_branch.png)
background-size: contain


???
A branch is a fundamental means of launching a seperate line of development with a project. Often a branch is then reconciled and merged with other branches. There are numerous reasons to create branches:

- it can represent a release version for a software project.
- it can represent a development phase of a project
- it can isolate development on a feature or fix.
- it can be the work of an individual contributor.

This graph shows the development of a project over time (left to right). Each circle represents a commit. The main branch (MASTER) is in the center. There are two branches stemming from the main branch. The bottom branch diverged from the master branch by adding or modifying the project to address Feature 1. It was then merged back into the master branch. The upper branch also diveged from the master branch and was merged in a seperate commit after Feature 1.


---
# Best practices

- How often to commit?
- Bran
???



---
background-image: url(images/github.jpg)
background-size: cover


???
So how does GitHub factor into all this?


---
# Initial setup

- Install **git** (requires FWS admin). 
    + Windows: https://git-scm.com/download/win

- Tell git your name and email address (the one from GitHub).
    + In the shell (*"Tools/Shell..." from new RStudio session*), run:

```{}
git config --global user.name "your-full-name"
git config --global user.email "your-email-address"
```

.pull-left[
- In **RStudio**, navigate to "*Tools/Global Options/Git/SVN*" and:  
    + Check the box for "Enable version control interface for RStudio projects".
    + Direct RStudio to your git executable file (git.exe). The default location is: "*C:/Program Files/Git/bin/git.exe*".
    + Create an SSH/RSA key.
]

.pull-right[
![](images/ssh_rstudio_marked.png)
]
---
# Initial setup (cont.)

- In **GitHub**:
    + [Create a GitHub user account](https://github.com/join).
    + Join the FWS GitHub organization ([@USFWS](https://github.com/USFWS)).
    + [Add the SSH key](https://github.com/settings/ssh/new) that you created in RStudio to your GitHub account ("*Settings/SSH and GBG keys/New SSH key*"). You only need to do this once.
  + Create a GitHub repository in the USFWS Github organization by contacting an  [owner](https://github.com/orgs/USFWS/people?query=role%3Aowner).


---
# Options...

&lt;br&gt;
&lt;br&gt;
## 1. Create a New Version Control RStudio Project  
&lt;br&gt;
## 2. Add Version Control to an RStudio Project


---
# Create a New Version Control RStudio Project

.pull-left[
- Create a GitHub repository, if you've not already.

- Create a new RStudio Project. 
    + Chose *Version Control* and *Git*. 
    + Enter your repository's URL. **Note that this is password-protected SSH URL (_NOT THE HTTP URL!_)**. For example *git@github.com:your-user-name/your-repo.git*. 
    + Name the project and assign a directory. 

- Make local changes and save them.
]

.pull-right[
![:scale 90%](images/new_project.png)

![:scale 90%](images/new_project2.png)
]
   
    
---
# Create a New Version Control RStudio Project

.pull-left[
* In RStudio
    + Navigate to the *Git* tab and check the boxes next the files and folders that you want included. 
    + Select *Commit*. 
    + Add a commit message.
    + Click *Commit* and then *Push*. 
        
- In GitHub:
    * Confirm that your changes were pushed to your GitHub repository.
]


---
# Add Version Control to an RStudio Project

.pull-left[
- Create a GitHub repository

- Open an existing RStudio project. In **Tools/Project Options/Git/SVN**, update **Version Control System** from **(None)** to **Git**. Initialize a new git repository.

- Under the **Git** tab in Rstudio, check files that you want Git to ignore. This is genenally output files and your .Rproj file. 

- Uncheck your ignore files. Check all files that you want to stage. Click **Commit**.

- Add a commit message.

- Click **Commit**. You've created a local Git repository.

]

.pull-right[

![](images/add_git.png)
]
???

---
# Add Version Control to an RStudio Project

- To push your local Git repository to GitHub. In the shell, type:

```{}
git remote add origin git@github.com:user-name/repository-name.git
git push -u origin master
```

- In GitHub:
    * Confirm that your changes were pushed to your GitHub repository.
    
     
---
# Glossary of terms
 
**Branch**: A named pointer to a specific snapshot. It notes the place where new changes should be applied to when this branch is used. When a change is applied to a branch, then also the branch label moves to the new commit. 

**Commit** (*verb and noun*): To create a snapshot of your code at a specific time. The name of the resulting snapshot.  

**Diff**: The difference of between the working directory and the given branch.

**Fork**: A copy of the remote repository that you manage. Forks let you make changes to a project without affecting the original repository. You can fetch updates from or submit changes to the original repository with pull requests.

**Git**: A free and open source distributed version control system.  

**GitHub**: A website for hosting projects that use Git.  

**Gitignore**: A file that specifies intentionally untracked files that Git should ignore.  

**History**: A series of snapshots committed for a repository over time.

---
# Glossary of terms (cont.)

**Merge**: A command to integrate version histories from multiple branches into a single branch.  

**Origin**: The shorthand name for the remote repository that a project was originally cloned from.  

**Parent**: The prior commit. Initial commit don't have a parent and merges have two parents.  

**Pull**: A command used to upload local repository contents to a remote repository. This is how you transfer commits from your local repository to the remote repository.  

**Push**: A command used to update a remote branch and local copy of the remote branch. Allows you to create new branches in the remote repository. 

**Revert**: To roll back one or more patch sets on the working directory, then creates a new commit on the result.  

**Shell**: The software that lets you interact with the computer via command line.  

**Snapshot**: A version created by the commit operation.


---
# Glossary of terms (cont.)

**SHA (secure hash algorithm)**: A unique identifier for an individual commit. 

**SSA Key**: An access credential that is used in the Secure Shell network protocol used to encrypt remote communications between machines. 

**Stage**: To prepare a file for a commit.


---
# Links to resources

- Git and GitHub basics
    + [Understanding the GitHub Workflow](https://guides.github.com/introduction/flow/)
- Installing Git and get it working smoothly with GitHub and RStudio
    + [Happy Git and GitHub for the useR](https://happygitwithr.com/)
    + [The "Git and GitHub" chapter in Hadley Wickham's "R Packages"](http://r-pkgs.had.co.nz/git.html)
    + [Using Git within RStudio (University of Chicago Computing for Social Sciences)]([Happy Git and GitHub for the useR](https://happygitwithr.com/)
    + [An introduction to Git and how to use it with RStudio (The R class-R programming for biologists)](https://r-bio.github.io/intro-git-rstudio/)  
    + [How to use Git with R and RStudio (Reproducible Research Workshop, U. of Zurich)](http://www.geo.uzh.ch/microsite/reproducible_research/post/rr-rstudio-git/)

- Tips and tricks
    + [How to write a Git Commit Message (Chris Beams)](https://chris.beams.io/posts/git-commit/)
    
- Publishing R Markdown documents using GitHub Pages
    + [GitHub whitepaper](https://resources.github.com/whitepapers/github-and-rstudio/)
    
    
---
class: center, middle

# Demo #1

## Creating a New Version Control RStudio Project


???

1. Creating a new RStudio project with Git version control

2. Add content.

3. Stage, Add Commit message and Commit changes to local repository.

4. Create a new repository in GitHub

6.     a. Cloning a GitHub repository to a local repository.

    



---
class: center, middle

# Demo #2

## Adding Version Control to an RStudio Project


---
class: center, middle

# Bonus Content! (if time allows)

## Installing an R package from GitHub

.left[

```r
# Load devtools:
install.packages(devtools)

# Install package from GitHub:
devtools::install_github("user-name/package-name)
```
]

???

Here's a quick and easy way to share an R package from GitHub.

```r
install.packages(devtools)
devtools::install_github("USFWS/SppDistMonProj")
```
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
